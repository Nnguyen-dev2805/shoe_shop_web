<!doctype html>
<html class="no-js" lang="" xmlns:th="http://www.thymeleaf.org">

<!-- Mirrored from htmldemo.net/james/james/single-product.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 05 Nov 2024 02:19:15 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Thông Tin Sản Phẩm || DeeG Shop</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- favicon
    ============================================ -->
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">

    <!-- Google Fonts
    ============================================ -->
    <link href='https://fonts.googleapis.com/css?family=Norican' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- Bootstrap CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <!-- Bootstrap CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <!-- owl.carousel CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/owl.carousel.css">
    <link rel="stylesheet" href="/css/owl.theme.css">
    <link rel="stylesheet" href="/css/owl.transitions.css">
    <!-- jquery-ui CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/jquery-ui.css">
    <!-- meanmenu CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/meanmenu.min.css">
    <!-- nivoslider CSS
    ============================================ -->
    <link rel="stylesheet" href="/lib/css/nivo-slider.css">
    <link rel="stylesheet" href="/lib/css/preview.css">
    <!-- animate CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/animate.css">
    <!-- magic CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/magic.css">
    <!-- normalize CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/normalize.css">
    <!-- main CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/main.css">
    <!-- style CSS
    ============================================ -->
    <link rel="stylesheet" href="/style.css">
    <!-- responsive CSS
    ============================================ -->
    <link rel="stylesheet" href="/css/responsive.css">
    <!-- modernizr JS
    ============================================ -->
    <script src="/js/vendor/modernizr-2.8.3.min.js"></script>
    <style>
        .fa-heart {
            color: red; /* Trái tim đỏ khi yêu thích */
        }

        .fa-heart-o {
            color: #ccc; /* Trái tim xám khi chưa yêu thích */
        }

        .rating-container {
            display: flex;
            gap: 5px;
        }

        .star {
            font-size: 30px;
            color: #ccc; /* Màu sao chưa được chọn */
            cursor: pointer;
        }

        .star.selected, .star.hover {
            color: gold; /* Màu sao được chọn hoặc hover */
        }
        
        /* Size buttons styling */
        .size-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .size-btn {
            min-width: 80px;
            padding: 10px 15px;
            border: 2px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
        }
        
        .size-btn:hover {
            border-color: rgb(245, 114, 98);
            color: rgb(245, 114, 98);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(245, 114, 98, 0.2);
        }
        
        .size-btn.active {
            border-color: rgb(245, 114, 98);
            background: rgb(245, 114, 98);
            color: white;
            font-weight: 600;
        }
        
        .size-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #f5f5f5;
        }
        
        .size-btn.disabled:hover {
            transform: none;
            box-shadow: none;
            border-color: #ddd;
        }
        
        /* Stock info */
        .stock-info {
            margin-top: 15px;
            padding: 10px 15px;
            background: #f0f8ff;
            border-left: 4px solid #4CAF50;
            border-radius: 4px;
        }
        
        .stock-info.low-stock {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
        
        .stock-info.out-of-stock {
            background: #f8d7da;
            border-left-color: #dc3545;
        }
        
        /* Quantity selector */
        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .quantity-selector label {
            font-weight: 600;
            margin-right: 10px;
        }
        
        .qty-controls {
            display: flex;
            align-items: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .qty-btn {
            width: 40px;
            height: 40px;
            background: #f5f5f5;
            border: none;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.2s;
            color: #333;
        }
        
        .qty-btn:hover {
            background: rgb(245, 114, 98);
            color: white;
        }
        
        .qty-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .qty-input {
            width: 60px;
            height: 40px;
            text-align: center;
            border: none;
            border-left: 1px solid #ddd;
            border-right: 1px solid #ddd;
            font-size: 16px;
            font-weight: 600;
        }
        
        .qty-input:focus {
            outline: none;
        }
        
        /* Price display */
        .price-breakdown {
            margin-top: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        
        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 15px;
        }
        
        .price-row.total {
            font-size: 20px;
            font-weight: bold;
            color: rgb(245, 114, 98);
            border-top: 2px solid #ddd;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        /* Product image zoom effect */
        .single-product-img {
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            background: white;
            padding: 20px;
        }
        
        .single-product-img img {
            width: 100%;
            height: auto;
            transition: transform 0.5s ease;
            cursor: zoom-in;
        }
        
        .single-product-img:hover img {
            transform: scale(1.1);
        }
        
        /* Product details card styling */
        .product-details-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            padding: 30px;
        }
        
        .product-name {
            font-size: 28px;
            font-weight: 700;
            color: #333;
            text-decoration: none;
            display: block;
            margin-bottom: 15px;
            line-height: 1.3;
        }
        
        .product-name:hover {
            color: rgb(245, 114, 98);
        }
        
        /* Rating section */
        .rating-section {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }
        
        .rating-section .ratings {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rating-section .ratings i {
            color: #ffc107;
            font-size: 18px;
        }
        
        .rating-info {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
        
        .rating-info strong {
            font-size: 14px;
            color: #666;
        }
        
        /* Availability badge */
        .availability-badge {
            display: inline-block;
            padding: 8px 16px;
            background: #d4edda;
            color: #155724;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .availability-badge.out-stock {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* Price section */
        .price-section {
            padding: 20px;
            background: linear-gradient(135deg, #fff5f3 0%, #ffe8e4 100%);
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #ffe0dc;
        }
        
        .item-price {
            margin: 0;
        }
        
        .item-price span {
            font-size: 36px;
            font-weight: 700;
            color: rgb(245, 114, 98);
            display: block;
        }
        
        /* Description section */
        .description-section {
            padding: 15px 0;
            margin-bottom: 20px;
        }
        
        .description-section p {
            font-size: 15px;
            line-height: 1.6;
            color: #666;
            margin: 0;
        }
        
        .description-section strong {
            color: #333;
            font-weight: 600;
        }
        
        /* Action buttons - Shopee Style */
        .shopee-action-section {
            padding: 20px 0;
            border-bottom: 1px solid #ebebeb;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .shopee-share-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .shopee-share-label {
            font-size: 14px;
            color: #757575;
        }
        
        .shopee-share-icons {
            display: flex;
            gap: 8px;
        }
        
        .shopee-share-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }
        
        .shopee-share-icon.facebook {
            background: #3b5998;
            color: white;
        }
        
        .shopee-share-icon.facebook:hover {
            background: #2d4373;
        }
        
        .shopee-share-icon.messenger {
            background: #0084ff;
            color: white;
        }
        
        .shopee-share-icon.messenger:hover {
            background: #006acc;
        }
        
        .shopee-share-icon.pinterest {
            background: #e60023;
            color: white;
        }
        
        .shopee-share-icon.pinterest:hover {
            background: #b5001a;
        }
        
        .shopee-share-icon.twitter {
            background: #000;
            color: white;
        }
        
        .shopee-share-icon.twitter:hover {
            background: #333;
        }
        
        .shopee-wishlist-section {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border: 1px solid #ee4d2d;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }
        
        .shopee-wishlist-section:hover {
            background: #fef6f5;
        }
        
        .shopee-wishlist-icon {
            color: #ee4d2d;
            font-size: 16px;
            transition: all 0.2s;
        }
        
        /* Icon tim đỏ khi đã thích (filled heart) */
        .shopee-wishlist-icon.fa-heart {
            color: #ee4d2d;
            animation: heartbeat 0.3s;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.2); }
            50% { transform: scale(1.1); }
        }
        
        .shopee-wishlist-text {
            font-size: 14px;
            color: #ee4d2d;
        }
        
        .shopee-wishlist-count {
            font-size: 14px;
            color: #757575;
        }
        
        /* Breadcrumb styles */
        .breadcrumb-area {
            transition: box-shadow 0.2s;
        }
        
        .breadcrumb-link {
            transition: color 0.2s;
        }
        
        .breadcrumb-link:hover {
            color: #ee4d2d !important;
        }
        
        .add-to-links {
            display: flex;
            gap: 10px;
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .add-to-links li a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border: 2px solid #ddd;
            border-radius: 50%;
            color: #666;
            transition: all 0.3s ease;
            background: white;
        }
        
        .add-to-links li a:hover {
            border-color: rgb(245, 114, 98);
            color: rgb(245, 114, 98);
            background: #fff5f3;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(245, 114, 98, 0.2);
        }
        
        .add-to-links li a i {
            font-size: 18px;
        }
        
        /* Size selection section */
        .size-selection-section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .size-select label {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: block;
        }
        
        .size-select label em {
            color: rgb(245, 114, 98);
        }
        
        /* Cart item container */
        .cart-item {
            margin-top: 20px;
            /*width: 100%;*/
            /*padding: 0;*/
        }
        
        .single-cart {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            /*padding: 0;*/
            /*margin: 0;*/
        }
        
        /* Add to cart button */
        .cart-btn {
            width: 100%;
            max-width: 100%;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgb(245, 114, 98);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(245, 114, 98, 0.3);
            text-align: center;
            display: block;
        }
        
        .cart-btn:hover:not(:disabled) {
            background: rgb(230, 99, 83);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(245, 114, 98, 0.4);
        }
        
        .cart-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .cart-btn i {
            margin-right: 8px;
        }
        
        /* Divider */
        .divider {
            height: 1px;
            background: #eee;
            margin: 20px 0;
        }
        
        /* ========== SHOPEE STYLE PRODUCT DETAILS ========== */
        .shopee-product-title {
            font-size: 20px;
            font-weight: 400;
            color: #333;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .shopee-rating-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #ebebeb;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .shopee-rating-score {
            display: flex;
            align-items: baseline;
            gap: 5px;
        }
        
        .rating-number {
            color: #ee4d2d;
            font-size: 16px;
            text-decoration: underline;
        }
        
        .rating-stars {
            color: #ee4d2d;
            font-size: 14px;
        }
        
        .rating-separator {
            color: #ccc;
        }
        
        .rating-stats {
            color: #767676;
            font-size: 14px;
        }
        
        .sold-count {
            color: #767676;
            font-size: 14px;
        }
        
        .shopee-price-section {
            background: #fafafa;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .shopee-price-row {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .shopee-price-original {
            color: #929292;
            font-size: 16px;
            text-decoration: line-through;
        }
        
        .shopee-price-sale {
            color: #ee4d2d;
            font-size: 30px;
            font-weight: 500;
        }
        
        .shopee-price-discount {
            background: #ee4d2d;
            color: #fff;
            padding: 2px 4px;
            border-radius: 2px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .shopee-info-row {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #ebebeb;
        }
        
        .shopee-info-label {
            min-width: 120px;
            color: #757575;
            font-size: 14px;
        }
        
        .shopee-info-content {
            flex: 1;
        }
        
        #product-description {
            color: #555;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .shopee-size-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .shopee-size-btn {
            min-width: 80px;
            padding: 8px 12px;
            border: 1px solid rgba(0,0,0,.09);
            background: #fff;
            cursor: pointer;
            border-radius: 2px;
            transition: all 0.1s;
            text-align: center;
            font-size: 14px;
            position: relative;
        }
        
        .shopee-size-btn:hover {
            border-color: #ee4d2d;
            color: #ee4d2d;
        }
        
        .shopee-size-btn.active {
            border-color: #ee4d2d;
            color: #ee4d2d;
        }
        
        .shopee-size-btn.active::before {
            content: "✓";
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            background: #ee4d2d;
            color: #fff;
            font-size: 10px;
            line-height: 15px;
            text-align: center;
        }
        
        .shopee-size-btn.out-of-stock {
            background: #fafafa;
            color: #999;
            border-color: #e0e0e0;
            cursor: pointer;
            opacity: 0.7;
        }
        
        .shopee-size-btn.out-of-stock:hover {
            border-color: #999;
            color: #666;
        }
        
        .shopee-qty-selector {
            display: flex;
            align-items: center;
        }
        
        .shopee-qty-btn {
            width: 32px;
            height: 32px;
            border: 1px solid rgba(0,0,0,.09);
            background: #fff;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #757575;
        }
        
        .shopee-qty-btn:hover {
            border-color: #ee4d2d;
            color: #ee4d2d;
        }
        
        .shopee-qty-input {
            width: 50px;
            height: 32px;
            border: 1px solid rgba(0,0,0,.09);
            border-left: none;
            border-right: none;
            text-align: center;
            font-size: 14px;
        }
        
        .shopee-action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .shopee-btn-add-cart {
            flex: 1;
            min-width: 200px;
            height: 48px;
            border: 1px solid #ee4d2d;
            background: rgba(255,87,34,.1);
            color: #ee4d2d;
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
            border-radius: 2px;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
            padding: 0 20px;
        }
        
        .shopee-btn-add-cart:hover:not(:disabled) {
            background: rgba(255,87,34,.15);
        }
        
        .shopee-btn-buy-now {
            flex: 1;
            min-width: 160px;
            height: 48px;
            border: none;
            background: #ee4d2d;
            color: #fff;
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
            border-radius: 2px;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
            padding: 0 20px;
        }
        
        .shopee-btn-buy-now:hover:not(:disabled) {
            background: #d73211;
        }
        
        .shopee-btn-add-cart:disabled,
        .shopee-btn-buy-now:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Price breakdown section */
        .shopee-price-breakdown {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 4px;
            margin-top: 20px;
        }
        
        .price-breakdown-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 14px;
            color: #333;
        }
        
        .price-breakdown-row.total {
            border-top: 1px dashed #ccc;
            margin-top: 10px;
            padding-top: 15px;
        }
        
        .price-breakdown-label {
            color: #757575;
        }
        
        .price-breakdown-value {
            font-weight: 500;
        }
        
        .price-breakdown-total {
            color: #ee4d2d;
            font-size: 20px;
            font-weight: 600;
        }
        
        /* Voucher section */
        .shopee-voucher-section {
            padding: 15px 0;
            border-bottom: 1px solid #ebebeb;
        }
        
        .shopee-voucher-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #757575;
            margin-bottom: 12px;
        }
        
        .shopee-voucher-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .shopee-voucher-badge {
            padding: 4px 8px;
            background: #fff;
            border: 1px solid #ee4d2d;
            color: #ee4d2d;
            font-size: 12px;
            border-radius: 2px;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .shopee-voucher-badge:hover {
            transform: translateY(-2px);
        }
        
        /* Order Voucher - Màu cam/đỏ */
        .shopee-voucher-badge.order-voucher {
            border-color: #ee4d2d;
            color: #ee4d2d;
        }
        
        .shopee-voucher-badge.order-voucher:hover {
            background: #fff5f5;
            box-shadow: 0 4px 8px rgba(238, 77, 45, 0.2);
        }
        
        /* Shipping Voucher - Màu xanh lá */
        .shopee-voucher-badge.shipping-voucher {
            border-color: #26aa99;
            color: #26aa99;
        }
        
        .shopee-voucher-badge.shipping-voucher:hover {
            background: #f0fffe;
            box-shadow: 0 4px 8px rgba(38, 170, 153, 0.2);
        }
        
        /* Voucher Tooltip */
        .voucher-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 12px;
            min-width: 280px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            pointer-events: none;
        }
        
        .shopee-voucher-badge:hover .voucher-tooltip {
            display: block;
        }
        
        .voucher-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: white;
        }
        
        .voucher-tooltip-header {
            font-size: 14px;
            font-weight: 600;
            color: #ee4d2d;
            margin-bottom: 8px;
        }
        
        .voucher-tooltip-body {
            font-size: 12px;
            color: #555;
            line-height: 1.5;
        }
        
        .voucher-tooltip-condition {
            padding: 6px 0;
            border-top: 1px dashed #e0e0e0;
            margin-top: 6px;
            font-size: 11px;
            color: #767676;
        }
        
        .voucher-tooltip-quantity {
            color: #ee4d2d;
            font-weight: 600;
        }
        
        /* Flash Sale Styles */
        .flash-sale-badge-container {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 10;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .flash-sale-badge {
            background: linear-gradient(135deg, #ff4b2b 0%, #ff416c 100%);
            color: white;
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-radius: 3px;
            box-shadow: 0 2px 8px rgba(255,75,43,0.4);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Flash Sale Banner - Shopee Style */
        .flash-sale-banner {
            background: linear-gradient(90deg, #ee4d2d 0%, #ff6b35 100%);
            padding: 8px 16px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .flash-sale-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .flash-sale-logo {
            color: white;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .flash-sale-logo i {
            font-size: 18px;
        }
        
        .flash-sale-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .flash-sale-label {
            color: white;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .flash-sale-label i {
            font-size: 14px;
        }
        
        .flash-sale-countdown {
            display: flex;
            gap: 4px;
        }
        
        .countdown-digit {
            background: #000;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            font-weight: 700;
            min-width: 30px;
            text-align: center;
        }
        
        .shopee-price-flash {
            background: #fef6f5;
            padding: 16px;
            border-radius: 4px;
        }
        
        .shopee-price-flash .shopee-price-sale {
            color: #ee4d2d !important;
            font-size: 32px !important;
            font-weight: 700 !important;
        }
        
        .shopee-price-flash .shopee-price-original {
            color: #929292 !important;
            font-size: 16px !important;
            text-decoration: line-through;
            margin-right: 10px;
        }
        
        .shopee-price-flash .shopee-price-discount {
            background: #ee4d2d !important;
            color: white !important;
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 13px !important;
            font-weight: 600 !important;
        }
        
        .flash-sale-stock-bar {
            margin-top: 15px;
            padding: 12px;
            background: #fff5f5;
            border-radius: 4px;
            border-left: 3px solid #ff4b2b;
        }
        
        .stock-progress-container {
            margin-bottom: 8px;
        }
        
        .stock-progress-bar {
            height: 16px;
            background: #f0f0f0;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }
        
        .stock-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff416c 0%, #ff4b2b 100%);
            display: flex;
            align-items: center;
            padding: 0 8px;
            transition: width 0.3s ease;
        }
        
        .stock-progress-text {
            color: white;
            font-size: 11px;
            font-weight: 600;
        }
        
        .stock-info-text {
            font-size: 12px;
            color: #ff4b2b;
            font-weight: 600;
        }
    </style>
</head>
<body style="background: #f5f5f5;">
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- header area start -->
<header th:replace="~{fragments/user/header :: header}"></header>
<!-- header area end -->

<!-- Breadcrumb Area -->
<div class="breadcrumb-area" style="background: #fff; padding: 15px 0; margin-bottom: 20px; box-shadow: 0 1px 2px rgba(0,0,0,0.05);">
    <div class="container">
        <div style="display: flex; align-items: center; gap: 15px;">
            <a href="javascript:history.back()" style="color: #ee4d2d; font-size: 18px; text-decoration: none;" title="Quay lại">
                <i class="fa fa-arrow-left"></i>
            </a>
            <div style="display: flex; align-items: center; gap: 8px; font-size: 16px;">
                <a href="/" class="breadcrumb-link" style="color: #666; text-decoration: none;">Trang chủ</a>
                <span style="color: #ccc;">/</span>
                <span style="color: #333; font-weight: 500;">Thông tin sản phẩm</span>
            </div>
        </div>
    </div>
</div>
<!-- single product details start -->
<div class="single-product-details" style="background: #f5f5f5; padding: 20px 0;">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="single-product-img tab-content">
                    <div class="single-pro-main-image tab-pane active" id="pro-large-img-1">
                        <a href="#"><img class="optima_zoom" id="product-image" src="" alt="Product Image"/></a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <img src="../../static/img/logo-1.png" height="134" width="269"/>
                <form action="#" method="post"><img src="../../static/img/logo-1.png" height="134" width="269"/>
                    <div class="single-product-details product-details-card">
                        <!-- Product Title (Shopee Style) -->
                        <h1 class="shopee-product-title" id="product-title">Loading...</h1>
                        
                        <!-- Rating Bar (Shopee Style) -->
                        <div class="shopee-rating-bar">
                            <div class="shopee-rating-score">
                                <span class="rating-number" id="product-rating-number">0.0</span>
                                <span class="rating-stars">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </span>
                            </div>
                            <span class="rating-separator">|</span>
                            <span class="rating-stats" id="product-reviews">0 Đánh Giá</span>
                            <span class="rating-separator">|</span>
                            <span class="sold-count">Đã Bán <strong id="product-sold-count">0</strong></span>
                        </div>
                        
                        <!-- Flash Sale Banner (Shopee Style) -->
                        <div class="flash-sale-banner" id="flash-sale-banner" style="display: none;">
                            <div class="flash-sale-left">
                                <div class="flash-sale-logo">
                                    <i class="fa fa-bolt"></i>
                                    <span>FLASH SALE</span>
                                </div>
                            </div>
                            <div class="flash-sale-right">
                                <div class="flash-sale-label">
                                    <i class="fa fa-clock-o"></i>
                                    <span>KẾT THÚC TRONG</span>
                                </div>
                                <div class="flash-sale-countdown" id="flash-sale-countdown">
                                    <span class="countdown-digit">00</span>
                                    <span class="countdown-digit">00</span>
                                    <span class="countdown-digit">00</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Price Section (Shopee Style) -->
                        <div class="shopee-price-section" id="price-section">
                            <div class="shopee-price-row">
                                <span class="shopee-price-sale" id="product-price">0₫</span>
                                <span class="shopee-price-original" id="original-price" style="display:none;">0₫</span>
                                <span class="shopee-price-discount" id="discount-badge" style="display:none;">0% GIẢM</span>
                            </div>
                        </div>
                        
                        <!-- Flash Sale Stock Info (Hidden - Shopee style without progress bar) -->
                        <div id="flash-sale-stock" style="display: none;"></div>
                        
                        <!-- Voucher Section: Mã giảm giá đơn hàng -->
                        <div class="shopee-voucher-section" id="order-voucher-section" style="display: none;">
                            <div class="shopee-voucher-label">
                                <i class="fa fa-ticket" style="color: #ee4d2d;"></i>
                                <span>Mã Giảm Giá Đơn Hàng</span>
                            </div>
                            <div class="shopee-voucher-list" id="order-voucher-list">
                                <!-- Order vouchers will be loaded via JavaScript -->
                                <span style="font-size: 12px; color: #999;">Đang tải vouchers...</span>
                            </div>
                        </div>
                        
                        <!-- Voucher Section: Mã giảm phí vận chuyển -->
                        <div class="shopee-voucher-section" id="shipping-voucher-section" style="display: none;">
                            <div class="shopee-voucher-label">
                                <i class="fa fa-truck" style="color: #26aa99;"></i>
                                <span>Mã Giảm Phí Vận Chuyển</span>
                            </div>
                            <div class="shopee-voucher-list" id="shipping-voucher-list">
                                <!-- Shipping vouchers will be loaded via JavaScript -->
                                <span style="font-size: 12px; color: #999;">Đang tải vouchers...</span>
                            </div>
                        </div>
                        
                        <!-- Action Buttons - Shopee Style -->
                        <div class="shopee-action-section">
                            <!-- Share Section -->
                            <div class="shopee-share-section">
                                <span class="shopee-share-label">Chia sẻ:</span>
                                <div class="shopee-share-icons">
                                    <a href="#" class="shopee-share-icon facebook" onclick="shareOnFacebook(); return false;" title="Facebook">
                                        <i class="fa fa-facebook"></i>
                                    </a>
<!--                                    <a href="#" class="shopee-share-icon messenger" onclick="shareOnMessenger(); return false;" title="Messenger">-->
<!--                                        <i class="fa fa-facebook-messenger"></i>-->
<!--                                    </a>-->
                                    <a href="#" class="shopee-share-icon pinterest" onclick="shareOnPinterest(); return false;" title="Pinterest">
                                        <i class="fa fa-pinterest"></i>
                                    </a>
                                    <a href="#" class="shopee-share-icon twitter" onclick="shareOnTwitter(); return false;" title="Twitter">
                                        <i class="fa fa-twitter"></i>
                                    </a>
                                </div>
                            </div>
                            
                            <!-- Wishlist Section -->
                            <div class="shopee-wishlist-section" 
                                 onclick="toggleWishlist(document.querySelector('.add-to-wishlist').getAttribute('data-product-id'), this);">
                                <i class="fa fa-heart-o shopee-wishlist-icon" id="wishlist-icon"></i>
                                <span class="shopee-wishlist-text">Đã thích</span>
                                <span class="shopee-wishlist-count" id="wishlist-count">(0)</span>
                                <!-- Hidden link for compatibility -->
                                <a href="#" class="add-to-wishlist" data-product-id="" style="display: none;"></a>
                            </div>
                        </div>
                        
                        <!-- Description (Shopee Style Row) -->
                        <div class="shopee-info-row" id="description-row">
                            <div class="shopee-info-label">Mô tả</div>
                            <div class="shopee-info-content" id="product-description">Loading...</div>
                        </div>
                        
                        <!-- Size Selection (Shopee Style) -->
                        <div class="shopee-info-row">
                            <div class="shopee-info-label">Size</div>
                            <div class="shopee-info-content">
                                <div class="shopee-size-grid" id="size-buttons">
                                    <!-- Size buttons will be loaded via AJAX -->
                                    <p>Đang tải sizes...</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quantity Selector (Shopee Style) -->
                        <div class="shopee-info-row" id="quantity-row" style="display: none;">
                            <div class="shopee-info-label">Số Lượng</div>
                            <div class="shopee-info-content">
                                <div class="shopee-qty-selector">
                                    <button type="button" class="shopee-qty-btn" id="qty-minus">−</button>
                                    <input type="text" class="shopee-qty-input" id="qty-input" name="quantity" value="1" readonly>
                                    <button type="button" class="shopee-qty-btn" id="qty-plus">+</button>
                                    <span style="margin-left: 15px; color: #757575; font-size: 14px;">
                                        <span id="stock-quantity">0</span> sản phẩm có sẵn
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Price Breakdown Section -->
                        <div class="shopee-price-breakdown" id="price-breakdown" style="display: none;">
                            <div class="price-breakdown-row">
                                <span class="price-breakdown-label">Giá cơ bản:</span>
                                <span class="price-breakdown-value" id="base-price-display">0₫</span>
                            </div>
                            <div class="price-breakdown-row">
                                <span class="price-breakdown-label">Phụ phí size:</span>
                                <span class="price-breakdown-value" id="size-fee-display">0₫</span>
                            </div>
                            <div class="price-breakdown-row total">
                                <span class="price-breakdown-label">Tổng cộng:</span>
                                <span class="price-breakdown-total" id="final-price-display">0₫</span>
                            </div>
                        </div>
                        
                        <!-- Hidden Price Data -->
                        <input type="hidden" id="final-price" value="0">
                        
                        <div class="cart-item">
                            <div class="single-cart">
                                <!-- Hidden inputs -->
                                <input type="hidden" id="productDetailId" name="productDetailId" value="">
                                <input type="hidden" id="selectedSize" name="selectedSize" value="">
                                
                                <!-- Action buttons (Shopee Style) -->
                                <div class="shopee-action-buttons">
                                    <button class="shopee-btn-add-cart" type="button" id="add-to-cart-btn" disabled>
                                        <i class="fa fa-shopping-cart"></i>
                                        <span>Thêm Vào Giỏ Hàng</span>
                                    </button>
                                    <button class="shopee-btn-buy-now" type="button" id="buy-now-btn" disabled>
                                        <span>Mua Ngay</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <!-- Alert message will be shown here -->
        </div>
    </div>
</div>
<!-- single product details end -->
<!-- single product tab start -->
<div class="single-product-tab-area" style="background: #f5f5f5; padding: 20px 0;">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="single-product-tab">
                    <ul class="nav single-product-tab-navigation" role="tablist">
<!--                        <li role="presentation">-->
<!--                            <a class="active" href="#tab1" aria-controls="tab1" role="tab" data-bs-toggle="tab">Product-->
<!--                                Description</a>-->
<!--                        </li>-->
                        <li role="presentation">
                            <a href="#tab2" aria-controls="tab2" role="tab" data-bs-toggle="tab" id="viewAllReview" data-product-id="">Xem danh sách đánh giá</a>
                        </li>
                    </ul>

                    <!-- Tab panes -->
                    <div class="tab-content single-product-page">
<!--                        <div role="tabpanel" class="tab-pane fade show active" id="tab1">-->
<!--                            <div class="single-p-tab-content">-->
<!--                                <p>Nunc facilisis sagittis ullamcorper. Proin lectus ipsum, gravida et mattis vulputate,-->
<!--                                    tristique ut lectus. Sed et lorem nunc. Vestibulum ante ipsum primis in faucibus-->
<!--                                    orci luctus et ultrices posuere cubilia Curae; Aenean eleifend laoreet congue.-->
<!--                                    Vivamus adipiscing nisl ut dolor dignissim semper. Nulla luctus malesuada tincidunt.-->
<!--                                    Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos-->
<!--                                    himenaeos. Integer enim purus, posuere at ultricies eu, placerat a felis.-->
<!--                                    Suspendisse aliquet urna pretium eros convallis interdum. Quisque in arcu id dui-->
<!--                                    vulputate mollis eget non arcu. Aenean et nulla purus. Mauris vel tellus non nunc-->
<!--                                    mattis lobortis. </p>-->
<!--                            </div>-->
<!--                        </div>-->
                        <div role="tabpanel" class="tab-pane fade" id="tab2">
                            <div class="single-p-tab-content" id="reviewsContent">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- single product tab end -->
<!-- upsell product area start-->
<!--        <div class="upsell-product home2">-->
<!--            <div class="container">-->
<!--                <div class="row">-->
<!--                    <div class="col-md-12">-->
<!--                        <div class="product-title">-->
<!--                            <h2>upsell products</h2>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="row">-->
<!--                    <div class="upsell-slider">-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/25.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/26.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/23.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/24.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/21.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/22.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/19.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/20.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/17.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/18.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/15.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/16.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/13.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/14.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/11.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/12.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="list-product-info">-->
<!--                                    <div class="price-rating">-->
<!--                                        <div class="ratings">-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star"></i>-->
<!--                                            <i class="fa fa-star-half-o"></i>-->
<!--                                            <a href="#" class="review">1 Review(s)</a>-->
<!--                                            <a href="#" class="add-review">Add Your Review</a>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!-- upsell product area end-->
<!-- related product area start-->
<!--        <div class="related-product home2">-->
<!--            <div class="container">-->
<!--                <div class="row">-->
<!--                    <div class="col-md-12">-->
<!--                        <div class="product-title">-->
<!--                            <h2>related products</h2>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="row">-->
<!--                    <div class="related-slider">-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/25.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/26.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/23.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/24.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/21.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/22.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/19.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/20.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/17.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/18.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/15.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/16.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/13.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/14.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-md-12">-->
<!--                            <div class="single-product">-->
<!--                                <div class="product-img">-->
<!--                                    <a href="single-product.html">-->
<!--                                        <img src="img/product/11.png" alt="" class="primary-img">-->
<!--                                        <img src="img/product/12.png" alt="" class="secondary-img">-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="product-price">-->
<!--                                    <div class="product-name">-->
<!--                                        <a href="single-product.html" title="Fusce aliquam">Fusce aliquam</a>-->
<!--                                    </div>-->
<!--                                    <div class="price-rating">-->
<!--                                        <span>$170.00</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!-- related product area end-->

<!-- footer area start -->
<div th:include="~{fragments/web/footer.html}"></div>
<!-- footer area end -->

<!-- jquery
============================================ -->
<script src="/js/vendor/jquery-1.12.4.min.js"></script>
<!-- bootstrap JS
============================================ -->
<script src="/js/bootstrap.min.js"></script>
<!-- wow JS
============================================ -->
<script src="/js/wow.min.js"></script>
<!-- price-slider JS
============================================ -->
<script src="/js/jquery-price-slider.js"></script>
<!-- nivoslider JS
============================================ -->
<script src="/lib/js/jquery.nivo.slider.js"></script>
<script src="/lib/home.js"></script>
<!-- meanmenu JS
============================================ -->
<script src="/js/jquery.meanmenu.js"></script>
<!-- owl.carousel JS
============================================ -->
<script src="/js/owl.carousel.min.js"></script>
<!-- elevatezoom JS
============================================ -->
<script src="/js/jquery.elevatezoom.js"></script>
<!-- scrollUp JS
============================================ -->
<script src="/js/jquery.scrollUp.min.js"></script>
<!-- plugins JS
============================================ -->
<script src="/js/plugins.js"></script>
<!-- main JS
============================================ -->
<script src="/js/main.js"></script>
<!-- Size price calculator đã được chuyển vào product-details.js -->
<!-- Wishlist Handler JS - RESTful API + Ajax + jQuery -->
<script src="/js/user/wishlist-handler.js"></script>

<!-- Share Functions -->
<script>
    function shareOnFacebook() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.getElementById('product-title').textContent);
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank', 'width=600,height=400');
    }
    
    function shareOnMessenger() {
        const url = encodeURIComponent(window.location.href);
        window.open(`https://www.facebook.com/dialog/send?link=${url}&app_id=YOUR_APP_ID&redirect_uri=${url}`, '_blank', 'width=600,height=400');
    }
    
    function shareOnPinterest() {
        const url = encodeURIComponent(window.location.href);
        const imageUrl = encodeURIComponent(document.getElementById('product-image').src);
        const description = encodeURIComponent(document.getElementById('product-title').textContent);
        window.open(`https://pinterest.com/pin/create/button/?url=${url}&media=${imageUrl}&description=${description}`, '_blank', 'width=600,height=400');
    }
    
    function shareOnTwitter() {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent(document.getElementById('product-title').textContent);
        window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank', 'width=600,height=400');
    }
</script>

<!-- Voucher Loader Script -->
<script>
    /**
     * Load active vouchers from API and render them
     */
    function loadActiveVouchers() {
        console.log('Loading active vouchers...');
        
        $.ajax({
            url: '/api/discount/active-vouchers',
            type: 'GET',
            dataType: 'json',
            success: function(vouchers) {
                console.log('✅ Vouchers loaded:', vouchers);
                
                if (vouchers && vouchers.length > 0) {
                    // Phân loại vouchers theo type
                    const orderVouchers = vouchers.filter(v => v.type === 'ORDER_DISCOUNT');
                    const shippingVouchers = vouchers.filter(v => v.type === 'SHIPPING_DISCOUNT');
                    
                    // Render order vouchers
                    if (orderVouchers.length > 0) {
                        renderOrderVouchers(orderVouchers);
                        $('#order-voucher-section').show();
                    }
                    
                    // Render shipping vouchers
                    if (shippingVouchers.length > 0) {
                        renderShippingVouchers(shippingVouchers);
                        $('#shipping-voucher-section').show();
                    }
                    
                    if (orderVouchers.length === 0 && shippingVouchers.length === 0) {
                        console.log('ℹ️ No active vouchers found');
                    }
                } else {
                    console.log('ℹ️ No active vouchers found');
                    $('#order-voucher-section').hide();
                    $('#shipping-voucher-section').hide();
                }
            },
            error: function(xhr, status, error) {
                console.error('❌ Error loading vouchers:', error);
                $('#voucher-section').hide();
            }
        });
    }
    
    /**
     * Render order discount vouchers
     */
    function renderOrderVouchers(vouchers) {
        const $list = $('#order-voucher-list');
        $list.empty();
        
        // Limit to 4 vouchers display
        const displayVouchers = vouchers.slice(0, 4);
        
        displayVouchers.forEach(voucher => {
            const badge = createOrderVoucherBadge(voucher);
            $list.append(badge);
        });
    }
    
    /**
     * Render shipping discount vouchers
     */
    function renderShippingVouchers(vouchers) {
        const $list = $('#shipping-voucher-list');
        $list.empty();
        
        // Limit to 4 vouchers display
        const displayVouchers = vouchers.slice(0, 4);
        
        displayVouchers.forEach(voucher => {
            const badge = createShippingVoucherBadge(voucher);
            $list.append(badge);
        });
    }
    
    /**
     * Create order voucher badge (màu cam)
     */
    function createOrderVoucherBadge(voucher) {
        const discountDisplay = getDiscountDisplay(voucher);
        const minOrderDisplay = formatVND(voucher.minOrderValue || 0);
        const maxDiscountDisplay = voucher.maxDiscountAmount ? formatVND(voucher.maxDiscountAmount) : 'Không giới hạn';
        
        return `
            <span class="shopee-voucher-badge order-voucher">
                ${discountDisplay}
                <div class="voucher-tooltip">
                    <div class="voucher-tooltip-header">
                        ${voucher.name}
                    </div>
                    <div class="voucher-tooltip-body">
                        ${getVoucherDescription(voucher)}
                    </div>
                    <div class="voucher-tooltip-condition">
                        <div>• Đơn tối thiểu: <strong>${minOrderDisplay}</strong></div>
                        <div>• Giảm tối đa: <strong>${maxDiscountDisplay}</strong></div>
                        <div>• HSD: ${formatDate(voucher.endDate)}</div>
                    </div>
                </div>
            </span>
        `;
    }
    
    /**
     * Create shipping voucher badge (màu xanh lá)
     */
    function createShippingVoucherBadge(voucher) {
        const discountDisplay = getDiscountDisplay(voucher);
        const minOrderDisplay = formatVND(voucher.minOrderValue || 0);
        
        return `
            <span class="shopee-voucher-badge shipping-voucher">
                ${discountDisplay}
                <div class="voucher-tooltip">
                    <div class="voucher-tooltip-header">
                        ${voucher.name}
                    </div>
                    <div class="voucher-tooltip-body">
                        ${getVoucherDescription(voucher)}
                    </div>
                    <div class="voucher-tooltip-condition">
                        <div>• Đơn tối thiểu: <strong>${minOrderDisplay}</strong></div>
                        ${voucher.maxDiscountAmount ? `<div>• Giảm tối đa: <strong>${formatVND(voucher.maxDiscountAmount)}</strong></div>` : ''}
                        <div>• HSD: ${formatDate(voucher.endDate)}</div>
                    </div>
                </div>
            </span>
        `;
    }
    
    /**
     * Get discount display text
     */
    function getDiscountDisplay(voucher) {
        if (voucher.discountValueType === 'PERCENTAGE') {
            return `Giảm ${Math.round(voucher.percent * 100)}%`;
        } else if (voucher.discountValueType === 'FIXED_AMOUNT') {
            return `Giảm ${formatVND(voucher.percent)}`;
        }
        return 'Giảm giá';
    }
    
    /**
     * Get voucher description
     */
    function getVoucherDescription(voucher) {
        if (voucher.type === 'SHIPPING_DISCOUNT') {
            if (voucher.discountValueType === 'PERCENTAGE') {
                return `Miễn phí ship ${Math.round(voucher.percent * 100)}%`;
            } else {
                return `Miễn phí ship ${formatVND(voucher.percent)}`;
            }
        } else {
            if (voucher.discountValueType === 'PERCENTAGE') {
                return `Giảm ${Math.round(voucher.percent * 100)}% tổng đơn hàng`;
            } else {
                return `Giảm ${formatVND(voucher.percent)} cho đơn hàng`;
            }
        }
    }
    
    /**
     * Format VND currency
     */
    function formatVND(amount) {
        if (!amount) return '0₫';
        return new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND'
        }).format(amount);
    }
    
    /**
     * Format date
     */
    function formatDate(dateString) {
        if (!dateString) return '';
        const date = new Date(dateString);
        return date.toLocaleDateString('vi-VN');
    }
</script>

<script>
    $(document).ready(function () {
        // Load vouchers on page load
        loadActiveVouchers();
        
        // Hàm lấy ProductID từ URL
        function getProductIdFromUrl() {
            var path = window.location.pathname; // Lấy đường dẫn hiện tại
            var parts = path.split('/'); // Tách đường dẫn thành mảng
            return parts[parts.length - 1]; // Phần cuối cùng là ProductID
        }

        // Hàm load review dựa vào ProductID và số trang
        function loadReviews(page) {
            var productId = getProductIdFromUrl(); // Lấy ProductID từ URL

            // Debug: kiểm tra giá trị
            console.log('Product ID:', productId, 'Page:', page);

            // Gửi request Ajax
            $.get("/rating", { productId: productId, page: page }, function (data) {
                // Cập nhật nội dung của reviewsContent
                $('#reviewsContent').html(data);

                // Gán lại sự kiện click cho các nút phân trang sau khi nội dung được cập nhật
                bindPaginationLinks();
            }).fail(function (error) {
                console.error('Error loading reviews:', error);
            });
        }

        // Hàm gắn sự kiện click cho các link phân trang
        function bindPaginationLinks() {
            // Lấy các link phân trang
            $('.pagination-link').off('click').on('click', function (e) {
                e.preventDefault(); // Ngăn chuyển hướng mặc định
                var page = $(this).data('page'); // Lấy số trang từ thuộc tính data-page

                // Kiểm tra số trang hợp lệ
                if (!isNaN(page)) {
                    loadReviews(page); // Gọi loadReviews để tải dữ liệu của trang mới
                } else {
                    console.error('Invalid page number');
                }
            });
        }

        // Sự kiện khi bấm vào nút "View all review"
        $('#viewAllReview').click(function (e) {
            e.preventDefault(); // Ngăn chuyển hướng mặc định

            // Tải dữ liệu review từ trang đầu tiên (page = 0)
            loadReviews(0);
        });

        // Gắn sự kiện click cho các nút phân trang (trường hợp nội dung ban đầu đã có sẵn)
        bindPaginationLinks();
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const stars = document.querySelectorAll('.star');
        const ratingInput = document.getElementById('rating');
        const form = document.getElementById('ratingForm');  // Lấy form theo id
        if (!form) return;

        form.addEventListener("submit", function (e) {
            // Kiểm tra nếu ratingInput không có giá trị
            if (!ratingInput.value) {
                e.preventDefault(); // Ngừng gửi form
                alert("Vui lòng chọn số sao trước khi gửi đánh giá!");
            }
        });

        stars.forEach((star, index) => {
            star.addEventListener('click', () => {
                // Kiểm tra nếu sao đã được chọn rồi
                if (ratingInput.value === star.dataset.value) {
                    // Nếu đã chọn, reset lại trạng thái sao và giá trị rating
                    ratingInput.value = '';
                    stars.forEach(s => s.classList.remove('selected'));
                } else {
                    // Nếu chưa chọn, gán giá trị rating và thay đổi trạng thái sao
                    ratingInput.value = star.dataset.value;
                    stars.forEach((s, i) => {
                        if (i <= index) {
                            s.classList.add('selected');
                        } else {
                            s.classList.remove('selected');
                        }
                    });
                }
            });

            // Tạo hiệu ứng hover từ trái sang phải
            star.addEventListener('mouseover', () => {
                stars.forEach((s, i) => {
                    if (i <= index) {
                        s.classList.add('hover');
                    } else {
                        s.classList.remove('hover');
                    }
                });
            });

            // Khôi phục trạng thái khi chuột rời
            star.addEventListener('mouseout', () => {
                stars.forEach((s) => s.classList.remove('hover'));
            });
        });
    });
</script>

<!-- Product Details AJAX Script -->
<script src="/js/web/product-details.js"></script>

<!-- Buy Now Feature Script -->
<script>
$(document).ready(function() {
    console.log('🚀 Buy Now script loaded!');
    
    /**
     * Handle Buy Now button click
     */
    console.log('🔗 Binding Buy Now button event handler...');
    const $buyNowBtn = $('#buy-now-btn');
    console.log('Buy Now button found:', $buyNowBtn.length, 'element(s)');
    
    $buyNowBtn.on('click', function(e) {
        console.log('🛒 Buy Now button clicked!');
        console.log('Button disabled?', $(this).prop('disabled'));
        console.log('Event:', e);
        
        // Validate selection
        const productDetailId = $('#productDetailId').val();
        const quantity = parseInt($('#qty-input').val());
        const selectedSize = $('#selectedSize').val();
        
        console.log('Validation data:', {
            productDetailId,
            quantity,
            selectedSize,
            currentProductDetail: window.currentProductDetail
        });
        
        if (!productDetailId) {
            console.log('❌ Validation failed: No product detail ID');
            alert('Vui lòng chọn size sản phẩm!');
            return;
        }
        
        if (quantity < 1) {
            console.log('❌ Validation failed: Invalid quantity');
            alert('Số lượng phải lớn hơn 0!');
            return;
        }
        
        // Get product detail data from window object (loaded by product-details.js)
        const productDetail = window.currentProductDetail;
        
        if (!productDetail) {
            console.log('❌ Validation failed: No product detail in window');
            alert('Không tải được thông tin sản phẩm. Vui lòng thử lại!');
            return;
        }
        
        console.log('✅ Validation passed, proceeding to authentication check...');

        // Disable button and show loading
        const $btn = $(this);
        $btn.prop('disabled', true);
        $btn.html('<i class="fa fa-spinner fa-spin"></i> Đang xử lý...');

        // Check if user is logged in by calling a simple API
        $.ajax({
            url: '/api/cart/count', // API endpoint that requires authentication
            method: 'GET',
            success: function(response) {
                // User is logged in, proceed with buy now
                console.log('✅ User is authenticated, proceeding to payment...');
                console.log('API /api/cart/count response:', response);
                
                // Calculate price
                const basePrice = window.currentProduct.price || 0;
                const sizePrice = productDetail.priceadd || 0;
                const unitPrice = basePrice + sizePrice;
                
                // Create order item data (same format as cart items)
                const orderItem = {
                    id: productDetail.id, // product detail ID
                    product: {
                        id: productDetail.id,
                        product: window.currentProduct,
                        size: selectedSize,
                        priceadd: sizePrice,
                        quantity: productDetail.quantity
                    },
                    quantity: quantity,
                    price: unitPrice
                };
                
                // Store in sessionStorage
                sessionStorage.setItem('selectedItems', JSON.stringify([orderItem]));
                sessionStorage.setItem('selectedAddressId', ''); // User will select address in payment page
                sessionStorage.setItem('cartId', ''); // No cart ID for buy now
                sessionStorage.setItem('buyNowMode', 'true'); // Flag to indicate buy now mode
                
                console.log('📦 Order data saved to sessionStorage:', {
                    orderItem,
                    buyNowMode: true
                });
                
                // Redirect to payment page
                console.log('🚀 Redirecting to payment page...');
                window.location.href = '/user/payment';
            },
            error: function(xhr, status, error) {
                console.error('❌ Authentication check error:', {
                    status: xhr.status,
                    statusText: xhr.statusText,
                    error: error,
                    response: xhr.responseText
                });
                
                // Reset button
                $btn.prop('disabled', false);
                $btn.html('<span>Mua Ngay</span>');
                
                if (xhr.status === 401) {
                    // User is not logged in
                    console.log('🔒 User not authenticated, redirecting to login...');
                    alert('Vui lòng đăng nhập để mua hàng!');
                    window.location.href = '/login';
                } else {
                    console.log('⚠️ Other error occurred:', xhr.status);
                    alert('Có lỗi xảy ra. Vui lòng thử lại!');
                }
            }
        });
    });
});

// Load ratings when tab is clicked
$(document).ready(function() {
    // Function to get product ID from URL path (same as existing function)
    function getProductIdFromUrl() {
        var path = window.location.pathname;
        var parts = path.split('/');
        return parts[parts.length - 1];
    }
    
    // Get product ID and set it to data attribute
    const productId = getProductIdFromUrl();
    console.log('Product ID from URL:', productId);
    
    if (productId) {
        $('#viewAllReview').data('product-id', productId);
    }
    
    // Handle tab click to load ratings
    $('#viewAllReview').on('click', function() {
        const productId = $(this).data('product-id');
        console.log('Loading ratings for product ID:', productId);
        if (productId) {
            loadProductRatings(productId);
        } else {
            console.error('No product ID found');
            $('#reviewsContent').html('<p class="text-danger">Không tìm thấy ID sản phẩm</p>');
        }
    });
    
    // Function to load and display ratings
    function loadProductRatings(productId) {
        console.log('Making API call to:', '/api/ratings/product/' + productId);
        
        $.ajax({
            url: '/api/ratings/product/' + productId,
            method: 'GET',
            success: function(response) {
                console.log('API Response:', response);
                if (response.success) {
                    console.log('Ratings found:', response.ratings.length);
                    console.log('Summary:', response.summary);
                    
                    // Store all ratings for button counting (only on initial load)
                    if (!currentFilterState) {
                        allRatings = response.ratings;
                    }
                    
                    displayRatings(response.ratings, response.summary, currentFilterState);
                } else {
                    console.error('API Error:', response.message);
                    $('#reviewsContent').html('<p class="text-danger">' + response.message + '</p>');
                }
            },
            error: function(xhr, status, error) {
                console.error('AJAX Error:', xhr, status, error);
                console.error('Response Text:', xhr.responseText);
                $('#reviewsContent').html('<p class="text-danger">Lỗi khi tải danh sách đánh giá: ' + error + '</p>');
            }
        });
    }
    
    // Function to display ratings
    function displayRatings(ratings, summary, currentFilter) {
        const reviewsContent = $('#reviewsContent');
        
        if (ratings.length === 0) {
            let message = 'Chưa có đánh giá nào cho sản phẩm này.';
            if (currentFilter) {
                if (currentFilter.star) {
                    message = `Chưa có đánh giá ${currentFilter.star} sao nào.`;
                } else if (currentFilter.hasComment) {
                    message = 'Chưa có đánh giá nào có bình luận.';
                } else if (currentFilter.hasImage) {
                    message = 'Chưa có đánh giá nào có hình ảnh.';
                }
            }
            reviewsContent.html(`<div style="text-align: center; padding: 40px; color: #999;"><p>${message}</p></div>`);
            return;
        }
        
        // Get real data from summary
        const averageStars = summary ? summary.averageStars || 0.0 : 0.0;
        const totalReviewers = summary ? summary.totalReviewers || 0 : 0;
        
        let html = `
            <div class="product-ratings" style="background: #fff; border-radius: 8px; padding: 20px;">
                <div class="product-rating-overview" style="margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #f0f0f0;">
                    <div class="product-rating-overview__briefing" style="display: flex; align-items: center; gap: 20px;">
                        <div class="product-rating-overview__score-wrapper" style="text-align: center;">
                            <span class="product-rating-overview__rating-score" style="font-size: 32px; font-weight: bold; color: #ee4d2d;">${averageStars.toFixed(1)}</span>
                            <span class="product-rating-overview__rating-score-out-of" style="color: #999; font-size: 14px;"> trên 5</span>
                        </div>
                        <div class="shopee-rating-stars" style="display: flex; gap: 2px;">
                            ${generateShopeeStars(averageStars)}
                        </div>
                    </div>
                </div>
                <div class="product-rating-overview__filters" style="margin-bottom: 20px; display: flex; gap: 8px; flex-wrap: wrap;">
                    ${window.generateFilterButtons(ratings, summary, currentFilter)}
                </div>
                <div class="product-ratings__list">
        `;
        
        ratings.forEach(function(rating) {
            const stars = generateShopeeStars(rating.star);
            const date = new Date(rating.createdDate).toLocaleDateString('vi-VN');
            const userName = rating.userName || 'Khách hàng';
            
            html += `
                <div class="q2b7Oq" style="border-bottom: 1px solid #f0f0f0; padding: 20px 0;">
                    <div class="kRbrbH" style="display: flex; gap: 12px;">
                        <div class="shopee-avatar" style="width: 40px; height: 40px; border-radius: 50%; background: #f0f0f0; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <svg width="20" height="20" viewBox="0 0 15 15" fill="#999">
                                <circle cx="7.5" cy="4.5" fill="none" r="3.8" stroke="#999" stroke-width="1"></circle>
                                <path d="m1.5 14.2c0-3.3 2.7-6 6-6s6 2.7 6 6" fill="none" stroke="#999" stroke-width="1"></path>
                            </svg>
                        </div>
                        <div class="A7MThp" style="flex: 1;">
                            <div class="d72He7" style="margin-bottom: 8px;">
                                <div class="InK5kS" style="font-weight: 600; color: #333; margin-bottom: 4px;">${userName}</div>
                                <div class="BnXxkm" style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                    <div class="rGdC5O" style="display: flex; gap: 1px;">
                                        ${stars}
                                    </div>
                                    <span style="background: #f0f0f0; padding: 2px 8px; border-radius: 12px; font-size: 12px; color: #666;">
                                        Size ${rating.productSize}
                                    </span>
                                </div>
                                <div class="j5ucs4">
                                    <div class="XYk98l" style="color: #999; font-size: 12px;">${date}</div>
                                </div>
                            </div>
                            <div class="meQyXP">
                                <div style="color: #888; font-size: 13px; margin-bottom: 8px;">
                                    📦 ${rating.productName}
                                </div>
                                <div class="YNedDV" style="color: #333; line-height: 1.5; margin-bottom: 12px;">${rating.comment}</div>
                                ${rating.image ? `
                                    <div class="ZBCPg1">
                                        <div class="rating-media-list">
                                            <div class="rating-media-list__container" style="display: flex; gap: 8px;">
                                                <div class="rating-media-list__image-wrapper" style="width: 72px; height: 72px; border-radius: 4px; overflow: hidden; cursor: pointer;">
                                                    <img src="${rating.image}" alt="Review image" style="width: 100%; height: 100%; object-fit: cover;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += `
                </div>
            </div>
        `;
        
        reviewsContent.html(html);
    }
    
    // Function to generate filter buttons - moved outside document.ready
    window.generateFilterButtons = function(ratings, summary, currentFilter) {
        const productId = $('#viewAllReview').data('product-id');
        let html = '';
        
        // Tất cả button
        const isAllActive = !currentFilter || (!currentFilter.star && !currentFilter.hasComment && !currentFilter.hasImage);
        html += `
            <div class="product-rating-overview__filter ${isAllActive ? 'product-rating-overview__filter--active' : ''}" 
                 style="padding: 8px 16px; border: 1px solid ${isAllActive ? '#ee4d2d' : '#ddd'}; border-radius: 4px; cursor: pointer; background: ${isAllActive ? '#ee4d2d' : 'white'}; color: ${isAllActive ? 'white' : '#333'}; font-size: 14px;"
                 onclick="window.filterRatings(${productId}, null, null, null, this)">
                <span>Tất cả</span>
            </div>
        `;
        
        // Show all star filter buttons (5, 4, 3, 2, 1) - use allRatings for counting
        for (let star = 5; star >= 1; star--) {
            const count = window.getStarCount(allRatings, star);
            if (count > 0) {
                const isActive = currentFilter && currentFilter.star === star;
                html += `
                    <div class="product-rating-overview__filter ${isActive ? 'product-rating-overview__filter--active' : ''}" 
                         style="padding: 8px 16px; border: 1px solid ${isActive ? '#ee4d2d' : '#ddd'}; border-radius: 4px; cursor: pointer; background: ${isActive ? '#ee4d2d' : 'white'}; color: ${isActive ? 'white' : '#333'}; font-size: 14px;"
                         onclick="window.filterRatings(${productId}, ${star}, null, null, this)">
                        <span>${star} Sao (${count})</span>
                    </div>
                `;
            }
        }
        
        // Image filter - use allRatings for counting
        const imageCount = window.getImageCount(allRatings);
        if (imageCount > 0) {
            const isActive = currentFilter && currentFilter.hasImage === true;
            html += `
                <div class="product-rating-overview__filter ${isActive ? 'product-rating-overview__filter--active' : ''}" 
                     style="padding: 8px 16px; border: 1px solid ${isActive ? '#ee4d2d' : '#ddd'}; border-radius: 4px; cursor: pointer; background: ${isActive ? '#ee4d2d' : 'white'}; color: ${isActive ? 'white' : '#333'}; font-size: 14px;"
                     onclick="window.filterRatings(${productId}, null, null, true, this)">
                    <span>Có hình ảnh / video (${imageCount})</span>
                </div>
            `;
        }
        
        return html;
    };
    
    // Helper functions to count ratings - moved outside document.ready
    window.getStarCount = function(ratings, star) {
        return ratings.filter(rating => rating.star === star).length;
    };
    
    window.getCommentCount = function(ratings) {
        return ratings.filter(rating => rating.comment && rating.comment.trim() !== '').length;
    };
    
    window.getImageCount = function(ratings) {
        return ratings.filter(rating => rating.image && rating.image.trim() !== '').length;
    };
    
    // Global variable to store current filter state
    let currentFilterState = null;
    
    // Global variable to store all ratings for button counting
    let allRatings = [];
    
    // Function to filter ratings - moved outside document.ready
    window.filterRatings = function(productId, star, hasComment, hasImage, clickedElement) {
        // Store current filter state
        currentFilterState = {
            star: star,
            hasComment: hasComment,
            hasImage: hasImage
        };
        
        // Build query parameters
        let url = '/api/ratings/product/' + productId;
        const params = [];
        
        if (star !== null) params.push('star=' + star);
        if (hasComment !== null) params.push('hasComment=' + hasComment);
        if (hasImage !== null) params.push('hasImage=' + hasImage);
        
        if (params.length > 0) {
            url += '?' + params.join('&');
        }
        
        console.log('Filtering with URL:', url);
        console.log('Current filter state:', currentFilterState);
        
        // Make API call
        $.ajax({
            url: url,
            method: 'GET',
            success: function(response) {
                console.log('Filtered API Response:', response);
                if (response.success) {
                    console.log('Filtered ratings found:', response.ratings.length);
                    displayRatings(response.ratings, response.summary, currentFilterState);
                } else {
                    console.error('API Error:', response.message);
                    $('#reviewsContent').html('<p class="text-danger">' + response.message + '</p>');
                }
            },
            error: function(xhr, status, error) {
                console.error('AJAX Error:', xhr, status, error);
                $('#reviewsContent').html('<p class="text-danger">Lỗi khi lọc đánh giá: ' + error + '</p>');
            }
        });
    };
    
    // Function to generate star HTML
    function generateStars(rating) {
        let stars = '';
        for (let i = 1; i <= 5; i++) {
            if (i <= rating) {
                stars += '<i class="fa fa-star" style="color: #ffc107;"></i>';
            } else {
                stars += '<i class="fa fa-star-o" style="color: #ddd;"></i>';
            }
        }
        return stars;
    }
    
    // Function to generate Shopee-style stars
    function generateShopeeStars(rating) {
        let stars = '';
        for (let i = 1; i <= 5; i++) {
            if (i <= Math.floor(rating)) {
                // Full star
                stars += `
                    <svg width="15" height="15" viewBox="0 0 15 15" fill="#ffc107">
                        <polygon points="7.5 .8 9.7 5.4 14.5 5.9 10.7 9.1 11.8 14.2 7.5 11.6 3.2 14.2 4.3 9.1 .5 5.9 5.3 5.4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"></polygon>
                    </svg>
                `;
            } else if (i === Math.ceil(rating) && rating % 1 !== 0) {
                // Half star
                const percentage = (rating % 1) * 100;
                stars += `
                    <div style="position: relative; width: 15px; height: 15px;">
                        <svg width="15" height="15" viewBox="0 0 15 15" fill="#ddd">
                            <polygon points="7.5 .8 9.7 5.4 14.5 5.9 10.7 9.1 11.8 14.2 7.5 11.6 3.2 14.2 4.3 9.1 .5 5.9 5.3 5.4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"></polygon>
                        </svg>
                        <div style="position: absolute; top: 0; left: 0; width: ${percentage}%; height: 100%; overflow: hidden;">
                            <svg width="15" height="15" viewBox="0 0 15 15" fill="#ffc107">
                                <polygon points="7.5 .8 9.7 5.4 14.5 5.9 10.7 9.1 11.8 14.2 7.5 11.6 3.2 14.2 4.3 9.1 .5 5.9 5.3 5.4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"></polygon>
                            </svg>
                        </div>
                    </div>
                `;
            } else {
                // Empty star
                stars += `
                    <svg width="15" height="15" viewBox="0 0 15 15" fill="#ddd">
                        <polygon points="7.5 .8 9.7 5.4 14.5 5.9 10.7 9.1 11.8 14.2 7.5 11.6 3.2 14.2 4.3 9.1 .5 5.9 5.3 5.4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"></polygon>
                    </svg>
                `;
            }
        }
        return stars;
    }
});
</script>

<!-- Chat Widget -->
<div th:replace="fragments/user/chat-widget :: chat-widget"></div>
</body>

<!-- Mirrored from htmldemo.net/james/james/single-product.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 05 Nov 2024 02:19:16 GMT -->
</html>
